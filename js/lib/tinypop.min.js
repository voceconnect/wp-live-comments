/**
 * TINYPOP - Lightweight growl like notifications in JavaScript
 *
 * Version: 1.0
 * Date: Feb 25th, 2012
 * Author: Srinath
 * Source: http://github.com/Checksum/tinypop
 * Demo: http://iambot.net/demo/tinypop/
 *
 */
;
(function(window, jQuery) {
	// Default options	
	var	count	= 0,
	speed		= {
		slow	: {
			step	: 5,
			timeout	: 75
		},
		normal	: {
			step	: 7.5,
			timeout	: 50
		},
		fast	: {
			step	: 10,
			timeout	: 25
		}
	},			
	defaults 	= {
		position: 'bottom-right',
		timeout	: 1500,
		sticky	: false,
		speed	: 'normal'
	};
	
	// Some private methods
	function $(id) {
		return document.getElementById(id);
	}

	
	// Our main object
	var TINYPOP = function(opts) 
	{
		var wrapper, 
		that = this;
	
		this.o = opts || {};
		
		// Override default options
		for( opt in defaults ) {
			if( !this.o.hasOwnProperty(opt) ) {
				this.o[opt] = defaults[opt];
			}
		}
		
		// Create the wrapper div if not exists
		wrapper = $("popwrap-"+this.o.position);
		if( !wrapper ) {
			wrapper = document.createElement("div");
			wrapper.className = 'popwrap '+this.o.position;
			document.body.appendChild(wrapper);
		}
		// Now create our popup div if it doesn't exist
		this.popup = document.createElement("div");
		this.popup.innerHTML = "<span class='close' id='close"+count+"'>&times;</span>";
		this.popup.innerHTML += "<div class='poptext'></div>";
		this.popup.className = "popup";
		this.popup.id = "popup"+count;
		// Add our popup to our wrapper
		wrapper.appendChild(this.popup);
		// Now increment our popup count
		count = count + 1;
	};
	
	// Expose these methods to our instance
	TINYPOP.prototype = {
		// Show a different message in the popup
		show: function(msg) {
			// Replace all " with \"
			msg = msg ? msg.replace('"','\"') : ' ';
			this.popup.children[1].innerHTML = msg;
			jQuery(this.popup).fadeIn(speed[this.o.speed].timeout)
		},
		// Hide the popup
		hide: function() {
			jQuery(this.popup).fadeOut(speed[this.o.speed].timeout)
		}
	};
	
	// Now expose our object to the global scope so that
	// you can create a new popup by doing new POPUP(msg)
	window.TINYPOP = TINYPOP;

})(window, jQuery);